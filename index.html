<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>Поетичні роздуми 1.3 </title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>

<body>

<h1>Поетичні роздуми</h1>
<div id="posts"></div>

<!-- LOGIN -->
<div id="login" style="display:none;position:fixed;inset:0;background:#0008;">
  <div style="background:#fff;padding:20px;max-width:300px;margin:15% auto;">
    <input type="password" id="pass" placeholder="Пароль">
    <button onclick="login()">Увійти</button>
  </div>
</div>

<!-- ADMIN -->
<div id="admin" style="display:none;">
  <h2>Адмінка</h2>
  <button onclick="logout()">Вийти</button><br><br>
  <input id="title" placeholder="Заголовок"><br><br>
  <textarea id="content" placeholder="Текст"></textarea><br><br>
  <button onclick="save()">Зберегти</button>
</div>

<script type="module">
/* ---------- FIREBASE ---------- */
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getDatabase, ref, push, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

const firebaseConfig = {
  apiKey: "AIzaSyAFV8kimd0f2dLw3yyQNj3fIyY4_5zCQB0",
  authDomain: "poetry-blog-ff72f.firebaseapp.com",
  databaseURL: "https://poetry-blog-ff72f-default-rtdb.europe-west1.firebasedatabase.app",
  projectId: "poetry-blog-ff72f",
  storageBucket: "poetry-blog-ff72f.appspot.com",
  messagingSenderId: "331598419628",
  appId: "1:331598419628:web:d1093b30ab867d3d40b109"
};

const app = initializeApp(firebaseConfig);
const db = getDatabase(app);

/* ---------- LOGIC ---------- */
const ADMIN_PASSWORD = "mypoetry2026";
const postsBox = document.getElementById("posts");

onValue(ref(db, "posts"), snap => {
  postsBox.innerHTML = "";
  snap.forEach(p => {
    const d = p.val();
    postsBox.innerHTML += `<div><h3>${d.title}</h3><p>${d.content}</p></div>`;
  });
});

window.save = () => {
  push(ref(db,"posts"), {
    title: title.value,
    content: content.value,
    date: Date.now()
  });
};

window.login = () => {
  if (pass.value === ADMIN_PASSWORD) {
    login.style.display="none";
    admin.style.display="block";
  }
};

window.logout = () => {
  admin.style.display="none";
};

/* ---------- HOTKEY ---------- */
document.addEventListener("keydown", e => {
  if (e.ctrlKey && e.shiftKey && e.code === "KeyZ") {
    e.preventDefault();
    login.style.display = "block";
  }
});
</script>

</body>
</html>
